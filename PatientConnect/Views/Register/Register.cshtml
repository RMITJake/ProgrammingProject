@model PatientConnect.ViewModels.RegisterVM

@{
    ViewData["Title"] = "Registration";
}
@* <div class="modal-left"><img src="/img/profile-icon.svg" class="profile-icon"></div><!-- modal-left--> *@
<div class="modal-grid">
    <div class="modal-header">
        <h4 class="modal-title">Register</h4>
    </div><!-- modal-header-->
    <div class="modal-body" id="loginModalBody">
        @* <form id="RegistrationForm" asp-action="Temp" asp-controller="Register"> *@
        <form id="registerForm" asp-action="Register" asp-controller="Register">
            <div class="form-group">
                <label asp-for="Email" class="control-label">Email</label>
                <input asp-for="Email" class="form-control" placeholder="Email" required>
            </div>

            @Html.ValidationMessage("EmailError", new { @class = "text-danger" })

            <div class="form-group">
                <label asp-for="Password" class="control-label">Password</label>
                <input type="password" asp-for="Password" class="form-control" placeholder="Password" required>
            </div>
            <div class="form-group">
                <label asp-for="PasswordConfirm" class="control-label">Confirm Password</label>
                <input type="password" asp-for="PasswordConfirm" class="form-control" placeholder="Confirm Password" required>
            </div>

            @Html.ValidationMessage("PasswordMismatch", new { @class = "text-danger" })

            <hr />
            <div class="form-group">
                <label asp-for="FirstName" class="control-label">First name</label>
                <input asp-for="FirstName" class="form-control" placeholder="First Name" required>
            </div>
            <div class="form-group">
                <label asp-for="LastName" class="control-label">Last name</label>
                <input asp-for="LastName" class="form-control" placeholder="Last Name" required>
            </div>
            <div class="form-group">
                <label asp-for="City" class="control-label">City</label>
                <input asp-for="City" class="form-control" placeholder="City" required>
            </div>
            <div class="form-group">
                <label asp-for="PostCode" class="control-label">Post Code</label>
                <input asp-for="PostCode" class="form-control" placeholder="Post Code" required>
            </div>
            <div class="form-group">
                <label asp-for="PhoneNumber" class="control-label">Phone number</label>
                <input asp-for="PhoneNumber" class="form-control" placeholder="Phone Number" required>
            </div>
            <div class="form-group">
                <label asp-for="UserType" class="control-label">I am a:</label>
                <select asp-for="UserType" asp-items="Html.GetEnumSelectList<UserType>()"
                        class="form-control" id="Role" onchange="toggleSpecialisationField()">
                </select>
            </div>
            <div class="form-group" id="SpecialisationField" style="display: none;">
                <label asp-for="Specialisation" class="control-label">Specialisation</label>
                <select asp-for="Specialisation" class="form-control" id="Specialisation">
                    <option value="Default">Select Specialisation</option>
                    <option value="InternalMedicine">Internal Medicine</option>
                    <option value="Pediatrics">Pediatrics</option>
                    <option value="Psychiatry">Psychiatry</option>
                    <option value="Surgery">Surgery</option>
                    <option value="OBGYN">OB/GYN</option>
                </select>
            </div>
            <div class="form-group" id="AgeField">
                <label asp-for="Age" class="control-label">Age</label>
                <input type="text" class="form-control" id="Age" name="Age" placeholder="Age">
            </div>
            <div class="form-group" id="ProviderNumberField" style="display: none;">
                <input type="text" class="form-control" id="ProviderNumber" name="ProviderNumber" placeholder="Provider Number">
            </div>
            @* <div class="form-group submit"> *@
            <div class="form-group">
                <input type="submit" value="Register" class="btn registerbutton" style="width: 150px">
            </div>
        </form>
    </div><!-- modal-body-->
    
</div>

@section Scripts {
    @{ await Html.RenderPartialAsync("_ValidationScriptsPartial"); }
}

<script>
    document.getElementById('form').addEventListener('submit', function(event){
        event.preventDefault();
        var formData = $("form#form").serialize();
        console.log(formData);
        $.ajax({
            type: "POST",
            url: "/Register",
            data: formData,
            dataType: 'json',
            error: function (errorData) {onError(errorData);}
        });
    });

    function toggleSpecialisationField() {
        var roleSelect = document.getElementById("Role");
        var specialisationField = document.getElementById("SpecialisationField");
        var ageField = document.getElementById("AgeField");
        var providerNumberField = document.getElementById("ProviderNumberField");


        if (roleSelect.value === '2') {
            specialisationField.style.display = "block";
            providerNumberField.style.display = "none";
            ageField.style.display = "none";
        }
        else if (roleSelect.value === '1') {
            ageField.style.display = "block";
            specialisationField.style.display = "none";
            providerNumberField.style.display = "none";
        } 
        else {
            providerNumberField.style.display = "none";
            specialisationField.style.display = "none";
            ageField.style.display = "none";
        }
    }
</script>

